<!-- clients.html Fragment - Enhanced Styling for SINC Legal System -->
<div id="sinc-client-management-container" class="p-4 md:p-6 bg-gray-50"> <!-- Added subtle background color -->

    <!-- Page Header - Enhanced with better spacing and typography -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
        <div>
            <h1 class="text-2xl font-bold text-gray-800 mb-1">Client Management</h1>
            <p class="text-sm text-gray-500">Manage your clients and prospects</p>
        </div>
        <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 w-full md:w-auto">
            <!-- Search Bar - Enhanced with better shadow and focus states -->
            <div class="relative flex-grow md:flex-grow-0 md:min-w-[300px]">
                <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                    <i class="fas fa-search text-gray-400"></i>
                </span>
                <input
                    id="sinc-client-search"
                    type="text"
                    placeholder="Search clients by Name, Company, Email..."
                    class="w-full rounded-md border-gray-300 shadow-sm py-2 pl-10 pr-3 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all"
                />
            </div>
            <!-- Add Client Button - Enhanced with transition and icon positioning -->
            <button id="sinc-add-client-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white rounded-md py-2 px-4 text-sm font-medium shadow-sm transition-colors flex items-center justify-center gap-1.5 whitespace-nowrap">
                <i class="fas fa-plus text-xs"></i>
                Add Client
            </button>
        </div>
    </div>

    <!-- Client List Card - Enhanced with better shadow and border -->
    <div class="bg-white shadow-lg rounded-xl overflow-hidden border border-gray-200">
        <!-- Filter Tabs - New addition -->
        <div class="flex border-b border-gray-200 bg-gray-50 px-4 text-sm font-medium">
            <button class="px-4 py-3 text-indigo-600 border-b-2 border-indigo-600">All Clients</button>
            <button class="px-4 py-3 text-gray-500 hover:text-gray-700">Active</button>
            <button class="px-4 py-3 text-gray-500 hover:text-gray-700">Prospects</button>
            <button class="px-4 py-3 text-gray-500 hover:text-gray-700">Inactive</button>
        </div>
        
        <!-- Responsive Table Wrapper -->
        <div class="overflow-x-auto">
            <table id="sinc-client-table" class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                        <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Active Cases</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                        <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                    </tr>
                </thead>
                <tbody id="sinc-client-table-body" class="bg-white divide-y divide-gray-200 text-sm">
                    <!-- Example Row 1 -->
                    <tr class="hover:bg-gray-50 transition-colors" data-client-id="CLNT001">
                        <td class="px-6 py-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-8 w-8 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center">
                                    <span class="font-medium text-sm">ND</span>
                                </div>
                                <div class="ml-3">
                                    <a href="#" class="font-medium text-indigo-600 hover:text-indigo-900 hover:underline sinc-view-client-link" title="View Client Details">Ndipha Duma</a>
                                    <div class="text-xs text-gray-500">Added: 2024-02-10</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-gray-600">
                            <div title="Email: n.duma@email.co.za" class="flex items-center">
                                <i class="fas fa-envelope fa-fw text-gray-400 mr-1.5"></i>
                                <span class="truncate max-w-[200px]">n.duma@email.co.za</span>
                            </div>
                            <div title="Phone: 083 111 2233" class="flex items-center mt-1">
                                <i class="fas fa-phone fa-fw text-gray-400 mr-1.5"></i>
                                <span>083 111 2233</span>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-gray-600">
                            Duma Consulting Pty Ltd
                        </td>
                        <td class="px-6 py-4 text-center">
                            <a href="#" class="sinc-view-client-cases-link inline-flex items-center justify-center h-6 w-6 rounded-full bg-indigo-100 text-indigo-600 font-medium hover:bg-indigo-200 transition-colors" title="View cases for Ndipha Duma">1</a>
                        </td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 text-xs font-medium rounded-full bg-emerald-100 text-emerald-800" title="Client has active ongoing matters">
                                Active
                            </span>
                        </td>
                        <td class="px-6 py-4 text-center">
                            <div class="flex items-center justify-center gap-1">
                                <button class="p-1.5 rounded-full text-indigo-600 hover:bg-indigo-100 transition-colors" title="View Details">
                                    <i class="fas fa-eye fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-amber-600 hover:bg-amber-100 transition-colors" title="Edit Client">
                                    <i class="fas fa-pencil-alt fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-blue-600 hover:bg-blue-100 transition-colors" title="Add New Case for Client">
                                    <i class="fas fa-folder-plus fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-red-600 hover:bg-red-100 transition-colors" title="Delete Client">
                                    <i class="fas fa-trash-alt fa-fw"></i>
                                </button>
                            </div>
                        </td>
                    </tr>

                    <!-- Example Row 2 -->
                    <tr class="hover:bg-gray-50 transition-colors" data-client-id="CLNT002">
                        <td class="px-6 py-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-8 w-8 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center">
                                    <span class="font-medium text-sm">JM</span>
                                </div>
                                <div class="ml-3">
                                    <a href="#" class="font-medium text-indigo-600 hover:text-indigo-900 hover:underline sinc-view-client-link" title="View Client Details">Jabulani Mkhize</a>
                                    <div class="text-xs text-gray-500">Added: 2023-11-15</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-gray-600">
                            <div title="Email: j.mkhize@corp.com" class="flex items-center">
                                <i class="fas fa-envelope fa-fw text-gray-400 mr-1.5"></i>
                                <span class="truncate max-w-[200px]">j.mkhize@corp.com</span>
                            </div>
                            <div title="Phone: 071 555 6677" class="flex items-center mt-1">
                                <i class="fas fa-phone fa-fw text-gray-400 mr-1.5"></i>
                                <span>071 555 6677</span>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-gray-600">
                            Ndlovu Properties (Director)
                        </td>
                        <td class="px-6 py-4 text-center">
                            <a href="#" class="sinc-view-client-cases-link inline-flex items-center justify-center h-6 w-6 rounded-full bg-indigo-100 text-indigo-600 font-medium hover:bg-indigo-200 transition-colors" title="View cases for Jabulani Mkhize">1</a>
                        </td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 text-xs font-medium rounded-full bg-emerald-100 text-emerald-800" title="Client has active ongoing matters">
                                Active
                            </span>
                        </td>
                        <td class="px-6 py-4 text-center">
                            <div class="flex items-center justify-center gap-1">
                                <button class="p-1.5 rounded-full text-indigo-600 hover:bg-indigo-100 transition-colors" title="View Details">
                                    <i class="fas fa-eye fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-amber-600 hover:bg-amber-100 transition-colors" title="Edit Client">
                                    <i class="fas fa-pencil-alt fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-blue-600 hover:bg-blue-100 transition-colors" title="Add New Case for Client">
                                    <i class="fas fa-folder-plus fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-red-600 hover:bg-red-100 transition-colors" title="Delete Client">
                                    <i class="fas fa-trash-alt fa-fw"></i>
                                </button>
                            </div>
                        </td>
                    </tr>

                    <!-- Example Row 3 (Prospect) -->
                    <tr class="hover:bg-gray-50 transition-colors" data-client-id="CLNT004">
                        <td class="px-6 py-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-8 w-8 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center">
                                    <span class="font-medium text-sm">JM</span>
                                </div>
                                <div class="ml-3">
                                    <a href="#" class="font-medium text-indigo-600 hover:text-indigo-900 hover:underline sinc-view-client-link" title="View Prospect Details">Jabu Mthembu</a>
                                    <div class="text-xs text-gray-500">Added: 2024-04-01</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-gray-600">
                            <div title="Email: jabu.m@mail.za" class="flex items-center">
                                <i class="fas fa-envelope fa-fw text-gray-400 mr-1.5"></i>
                                <span class="truncate max-w-[200px]">jabu.m@mail.za</span>
                            </div>
                            <div title="Phone: 060 123 9876" class="flex items-center mt-1">
                                <i class="fas fa-phone fa-fw text-gray-400 mr-1.5"></i>
                                <span>060 123 9876</span>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-gray-400 italic">
                            N/A
                        </td>
                        <td class="px-6 py-4 text-gray-500 text-center">
                            <span class="text-gray-400">0</span>
                        </td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 text-xs font-medium rounded-full bg-amber-100 text-amber-800" title="Potential client, no active matters yet">
                                Prospect
                            </span>
                        </td>
                        <td class="px-6 py-4 text-center">
                            <div class="flex items-center justify-center gap-1">
                                <button class="p-1.5 rounded-full text-indigo-600 hover:bg-indigo-100 transition-colors" title="View Details">
                                    <i class="fas fa-eye fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-amber-600 hover:bg-amber-100 transition-colors" title="Edit Prospect">
                                    <i class="fas fa-pencil-alt fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-green-600 hover:bg-green-100 transition-colors" title="Convert to Client & Add Case">
                                    <i class="fas fa-user-check fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-red-600 hover:bg-red-100 transition-colors" title="Delete Prospect">
                                    <i class="fas fa-trash-alt fa-fw"></i>
                                </button>
                            </div>
                        </td>
                    </tr>

                    <!-- Example Row 4 (Inactive) -->
                    <tr class="hover:bg-gray-50 bg-gray-50/50 transition-colors" data-client-id="CLNT005">
                        <td class="px-6 py-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-8 w-8 bg-gray-200 text-gray-600 rounded-full flex items-center justify-center">
                                    <span class="font-medium text-sm">SC</span>
                                </div>
                                <div class="ml-3">
                                    <a href="#" class="font-medium text-indigo-600 hover:text-indigo-900 hover:underline sinc-view-client-link" title="View Client Details">Sipho Cele</a>
                                    <div class="text-xs text-gray-500">Added: 2022-08-15</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-gray-600">
                            <div title="Email: scele@oldmail.com" class="flex items-center">
                                <i class="fas fa-envelope fa-fw text-gray-400 mr-1.5"></i>
                                <span class="truncate max-w-[200px]">scele@oldmail.com</span>
                            </div>
                            <div title="Phone: 079 000 1122" class="flex items-center mt-1">
                                <i class="fas fa-phone fa-fw text-gray-400 mr-1.5"></i>
                                <span>079 000 1122</span>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-gray-600">
                            Cele Logistics (Former)
                        </td>
                        <td class="px-6 py-4 text-gray-500 text-center">
                            <span class="text-gray-400">0</span>
                        </td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-700" title="No active matters for some time">
                                Inactive
                            </span>
                        </td>
                        <td class="px-6 py-4 text-center">
                            <div class="flex items-center justify-center gap-1">
                                <button class="p-1.5 rounded-full text-indigo-600 hover:bg-indigo-100 transition-colors" title="View Details">
                                    <i class="fas fa-eye fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-amber-600 hover:bg-amber-100 transition-colors" title="Edit Client">
                                    <i class="fas fa-pencil-alt fa-fw"></i>
                                </button>
                                <button class="p-1.5 rounded-full text-red-600 hover:bg-red-100 transition-colors" title="Delete Client Record">
                                    <i class="fas fa-trash-alt fa-fw"></i>
                                </button>
                            </div>
                        </td>
                    </tr>

                    <!-- No Results Row -->
                    <tr id="sinc-no-clients-row" class="hidden">
                        <td colspan="6" class="px-6 py-12 text-center">
                            <div class="flex flex-col items-center">
                                <i class="fas fa-search text-gray-300 text-3xl mb-2"></i>
                                <p class="text-gray-500 font-medium mb-1">No clients found</p>
                                <p class="text-gray-400 text-sm">Try adjusting your search or filters</p>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div> <!-- End Responsive Table Wrapper -->

        <!-- Pagination Controls - Enhanced with better spacing and visual design -->
        <div class="px-6 py-4 border-t border-gray-200 bg-gray-50 flex flex-col sm:flex-row justify-between items-center gap-4">
            <div id="sinc-pagination-info" class="text-sm text-gray-600">
                Showing <span class="font-semibold">1</span> to <span class="font-semibold">4</span> of <span class="font-semibold">25</span> results
            </div>
            <div class="flex items-center space-x-2">
                <button id="sinc-prev-page-btn" class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:bg-gray-100 disabled:cursor-not-allowed transition-colors" disabled>
                    <i class="fas fa-chevron-left mr-1 text-xs"></i>
                    <span class="hidden sm:inline">Previous</span>
                </button>
                <div class="hidden md:flex space-x-1">
                    <button class="inline-flex items-center justify-center w-8 h-8 border border-indigo-500 bg-indigo-50 text-indigo-600 text-sm font-medium rounded-md">1</button>
                    <button class="inline-flex items-center justify-center w-8 h-8 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 text-sm font-medium rounded-md">2</button>
                    <button class="inline-flex items-center justify-center w-8 h-8 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 text-sm font-medium rounded-md">3</button>
                    <span class="inline-flex items-center justify-center w-8 h-8 text-gray-500">...</span>
                    <button class="inline-flex items-center justify-center w-8 h-8 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 text-sm font-medium rounded-md">5</button>
                </div>
                <button id="sinc-next-page-btn" class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:bg-gray-100 disabled:cursor-not-allowed transition-colors">
                    <span class="hidden sm:inline">Next</span>
                    <i class="fas fa-chevron-right ml-1 text-xs"></i>
                </button>
            </div>
        </div>

    </div> <!-- End Client List Card -->

    <!-- Styles - Improved with modern design elements -->
    <style>
        /* Input/Button Reset */
        input, button {
            outline: none;
        }
        
        /* Table hover transition */
        tr {
            transition: background-color 0.15s ease-in-out;
        }
        
        /* Override Tailwind reset for focus styles */
        input:focus, button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);
        }
        
        /* Custom scrollbar for table */
        .overflow-x-auto::-webkit-scrollbar {
            height: 8px;
        }
        
        .overflow-x-auto::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .overflow-x-auto::-webkit-scrollbar-thumb {
            background: #c5c5c5;
            border-radius: 4px;
        }
        
        .overflow-x-auto::-webkit-scrollbar-thumb:hover {
            background: #a5a5a5;
        }
    </style>

        <!-- Basic Interactivity Script (Enhanced with smoother animations) -->
        <script>
            // Wrap in an IIFE (Immediately Invoked Function Expression)
            // to avoid polluting the global scope and execute immediately when the fragment loads.
            (() => {
                const container = document.getElementById('sinc-client-management-container');
                if (!container) {
                    console.error("SINC Client Management container not found. Script cannot initialize.");
                    return; // Stop execution if the container isn't found
                }
    
                // --- Select elements scoped to the container ---
                const addClientBtn = container.querySelector('#sinc-add-client-btn');
                const searchInput = container.querySelector('#sinc-client-search');
                const tableBody = container.querySelector('#sinc-client-table-body');
                const noResultsRow = container.querySelector('#sinc-no-clients-row');
                const paginationInfoEl = container.querySelector('#sinc-pagination-info');
                const prevPageBtn = container.querySelector('#sinc-prev-page-btn');
                const nextPageBtn = container.querySelector('#sinc-next-page-btn');
                const filterTabs = container.querySelectorAll('.flex.border-b > button'); // Be slightly more specific
    
                let allRows = [];
                let debounceTimeout = null;
    
                // --- Initialization Function ---
                const initClientList = () => {
                    if (!tableBody) {
                        console.error("SINC Client table body not found.");
                        return;
                    }
                    // Select only direct children `tr` elements that are not the 'no results' row
                    allRows = Array.from(tableBody.querySelectorAll(':scope > tr:not(#sinc-no-clients-row)'));
    
                    // Initial filter (apply search and default tab) - Important to call *after* allRows is populated
                    filterClients(); // Applies search filter
                    applyStatusFilter('all clients'); // Apply the default 'All Clients' tab filter
    
                    // Add fade-in animation to table rows (only for initially visible rows)
                    // Note: Might be better to apply animation *after* filtering
                    // Let's move animation inside the filter functions for better control.
                    // allRows.forEach((row, index) => { ... }); // Remove initial animation here
                };
    
                // --- Add New Client Simulation ---
                addClientBtn?.addEventListener('click', () => {
                    // Animation for button
                    addClientBtn.classList.add('scale-95', 'opacity-80');
                    setTimeout(() => {
                        addClientBtn.classList.remove('scale-95', 'opacity-80');
                        alert('Simulating: Open "Add New Client" form/modal...');
                        // In a real app, trigger navigation or modal display
                    }, 150);
                });
    
                // --- Debounced Search Filter Logic ---
                const filterClients = () => {
                    if (!tableBody || !searchInput || !noResultsRow) return; // Guard clauses
    
                    // Clear previous timeout
                    if (debounceTimeout) {
                        clearTimeout(debounceTimeout);
                    }
    
                    // Set new timeout
                    debounceTimeout = setTimeout(() => {
                        const searchTerm = searchInput.value.toLowerCase().trim();
                        // Get the currently active status filter
                        const activeTab = container.querySelector('.flex.border-b > button.border-indigo-600');
                        const currentStatusFilter = activeTab ? activeTab.textContent.trim().toLowerCase() : 'all clients'; // Default if somehow none is active
    
                        let visibleCount = 0;
    
                        allRows.forEach((row, index) => {
                            // Get data for filtering
                            const nameCellText = row.cells[0]?.textContent.toLowerCase() || '';
                            const contactCellText = row.cells[1]?.textContent.toLowerCase() || '';
                            const companyCellText = row.cells[2]?.textContent.toLowerCase() || '';
                            const statusBadge = row.cells[4]?.querySelector('span');
                            const statusText = statusBadge?.textContent.trim().toLowerCase() || '';
    
                            // Apply Filters
                            const matchesSearch = !searchTerm ||
                                nameCellText.includes(searchTerm) ||
                                contactCellText.includes(searchTerm) ||
                                companyCellText.includes(searchTerm);
    
                            const matchesStatus = currentStatusFilter === 'all clients' || statusText === currentStatusFilter;
    
                            const isVisible = matchesSearch && matchesStatus;
    
                            // Apply visibility and animation
                            if (isVisible) {
                                row.style.transition = 'opacity 0.3s ease, transform 0.3s ease'; // Ensure transition is set
                                row.style.display = ''; // Make sure it's not 'none' before animating in
                                setTimeout(() => { // Use timeout to allow display change to register
                                    row.style.opacity = '1';
                                    row.style.transform = 'translateY(0)';
                                }, 10); // Small delay
                                visibleCount++;
                            } else {
                                row.style.transition = 'opacity 0.3s ease, transform 0.3s ease'; // Ensure transition is set
                                row.style.opacity = '0';
                                row.style.transform = 'translateY(5px)';
                                // Use transitionend event listener for more robust hiding,
                                // but setTimeout is simpler for this example.
                                setTimeout(() => {
                                    if (row.style.opacity === '0') { // Check if it's still supposed to be hidden
                                         row.style.display = 'none';
                                    }
                                }, 300); // Match transition duration
                            }
                        });
    
                        // Update "no results" row
                        noResultsRow.style.transition = 'opacity 0.3s ease';
                        if (visibleCount === 0) {
                            noResultsRow.style.display = '';
                            setTimeout(() => { noResultsRow.style.opacity = '1'; }, 10);
                        } else {
                            noResultsRow.style.opacity = '0';
                            setTimeout(() => { if(noResultsRow.style.opacity === '0') noResultsRow.style.display = 'none'; }, 300);
                        }
    
                        // Update pagination summary (basic example)
                        updatePagination(visibleCount);
    
                    }, 250); // 250ms debounce - adjust as needed
                };
    
                // --- Status Filter Logic (called by tab clicks) ---
                const applyStatusFilter = (filterValue) => { // filterValue should be lowercase e.g., 'all clients', 'active'
                     filterClients(); // Re-run the main filter logic which now considers status
                };
    
                // --- Update Pagination Info ---
                const updatePagination = (visibleCount) => {
                     if (paginationInfoEl) {
                        const totalClients = allRows.length; // This might need adjustment if data is truly paginated
                        const itemsPerPage = 10; // Assuming 10 items per page for example
                        const showing = Math.min(visibleCount, itemsPerPage); // Show up to itemsPerPage or visible count
                        const activeTab = container.querySelector('.flex.border-b > button.border-indigo-600');
                        const currentStatusFilter = activeTab ? activeTab.textContent.trim() : 'All Clients';
                        const filterSuffix = currentStatusFilter !== 'All Clients' ? ` (${currentStatusFilter})` : '';
                        const searchSuffix = searchInput.value.trim() ? ' (Filtered by search)' : '';
    
                        paginationInfoEl.innerHTML = `Showing <span class="font-semibold">${visibleCount > 0 ? 1 : 0}</span> to <span class="font-semibold">${showing}</span> of <span class="font-semibold">${visibleCount}</span> results${filterSuffix}${searchSuffix}`;
                        // In a real app, update total based on actual total items from backend if paginated
                     }
    
                    // Update pagination buttons (simple example for page 1)
                    prevPageBtn.disabled = true; // Always disabled in this simple version
                    nextPageBtn.disabled = visibleCount <= 10; // Disable if 10 or fewer results shown
                };
    
    
                // --- Attach Event Listeners ---
                searchInput?.addEventListener('input', filterClients);
    
                // --- Event Delegation for Table Actions ---
                tableBody?.addEventListener('click', (event) => {
                    const targetButton = event.target.closest('button, a.sinc-view-client-link, a.sinc-view-client-cases-link'); // Target buttons OR specific links
                    if (!targetButton) return;
    
                    const row = targetButton.closest('tr');
                    if (!row) return;
    
                     // Prevent default for '#' links
                     if (targetButton.tagName === 'A' && targetButton.getAttribute('href') === '#') {
                        event.preventDefault();
                     }
    
                    // Visual feedback for buttons
                    if (targetButton.tagName === 'BUTTON') {
                        targetButton.style.transition = 'transform 0.1s ease'; // Quick feedback
                        targetButton.classList.add('scale-90', 'opacity-80');
                        setTimeout(() => {
                            targetButton.classList.remove('scale-90', 'opacity-80');
                        }, 150);
                    }
    
                    const clientId = row.dataset.clientId;
                    const clientNameLink = row.querySelector('a.sinc-view-client-link');
                    const clientName = clientNameLink?.textContent.trim() || 'this client';
    
                    // Handle button/link clicks based on class or icon
                    if (targetButton.matches('a.sinc-view-client-link') || targetButton.querySelector('.fa-eye')) {
                        alert(`Simulating: View Client Details for ${clientName} (ID: ${clientId})`);
                        // Real SPA: router.navigate('/clients/' + clientId);
                    } else if (targetButton.matches('a.sinc-view-client-cases-link')) {
                         event.preventDefault(); // Ensure navigation doesn't happen if it's a link
                        alert(`Simulating: View Cases filtered for Client: ${clientName} (ID: ${clientId})`);
                        // Real SPA: router.navigate('/cases?clientId=' + clientId);
                    } else if (targetButton.querySelector('.fa-pencil-alt')) {
                        alert(`Simulating: Edit ${clientName} (ID: ${clientId})`);
                        // Real SPA: showEditModal(clientId) or router.navigate('/clients/' + clientId + '/edit');
                    } else if (targetButton.querySelector('.fa-folder-plus')) {
                        alert(`Simulating: Add New Case for Client: ${clientName} (ID: ${clientId})`);
                         // Real SPA: showAddCaseModal(clientId);
                    } else if (targetButton.querySelector('.fa-user-check')) { // Convert Prospect
                        alert(`Simulating: Convert Prospect ${clientName} (ID: ${clientId}) to Client`);
                        // --- In a real app: ---
                        // 1. Make API call to update client status.
                        // 2. On success, update the row visually OR re-fetch/re-render.
    
                        // --- Simulation: Update row visually ---
                        const statusBadge = row.cells[4]?.querySelector('span');
                        const avatar = row.querySelector('.flex-shrink-0');
                        const convertBtn = targetButton; // Button that was clicked
    
                         if (statusBadge) {
                            statusBadge.className = 'px-2 py-1 text-xs font-medium rounded-full bg-emerald-100 text-emerald-800';
                            statusBadge.textContent = 'Active';
                            statusBadge.title = 'Client has active ongoing matters';
                        }
                        if (avatar) {
                            avatar.className = avatar.className.replace(/bg-amber-100 text-amber-600/, 'bg-indigo-100 text-indigo-600');
                        }
                        // Change the 'Convert' button to 'Add Case'
                        convertBtn.title = 'Add New Case for Client';
                        convertBtn.classList.remove('text-green-600', 'hover:bg-green-100');
                        convertBtn.classList.add('text-blue-600', 'hover:bg-blue-100');
                        convertBtn.innerHTML = '<i class="fas fa-folder-plus fa-fw"></i>';
    
                         // Optionally re-filter if the current view is 'Prospects'
                         filterClients();
    
                    } else if (targetButton.querySelector('.fa-trash-alt')) {
                        if (confirm(`Are you sure you want to delete the client "${clientName}"? This action cannot be undone.`)) {
                            alert(`Simulating: Deleting ${clientName} (ID: ${clientId})`);
                            // --- In a real app: ---
                            // 1. Make API call to delete the client.
                            // 2. On success, remove the row and update counts.
    
                            // --- Simulation: Remove row with animation ---
                            row.style.transition = 'opacity 0.4s ease, transform 0.4s ease, height 0.4s ease 0.2s'; // Add height transition delayed
                            row.style.opacity = '0';
                            row.style.transform = 'translateX(50px)';
                            row.style.height = row.offsetHeight + 'px'; // Set initial height
    
                            setTimeout(() => {
                                row.style.height = '0px';
                                row.style.paddingTop = '0';
                                row.style.paddingBottom = '0';
                                row.style.border = 'none'; // Avoid border flash during collapse
                            }, 50); // Start collapse slightly after opacity/transform starts
    
                             setTimeout(() => {
                                 const rowIndex = allRows.indexOf(row);
                                 if (rowIndex > -1) {
                                     allRows.splice(rowIndex, 1); // Remove from our JS array
                                 }
                                 row.remove(); // Remove from DOM
                                 filterClients(); // Update counts and potentially show "no results"
                             }, 450); // Remove after animation duration
                        }
                    }
                });
    
                // --- Pagination Button Clicks (Simulation) ---
                prevPageBtn?.addEventListener('click', () => {
                    prevPageBtn.classList.add('scale-95', 'opacity-80');
                    setTimeout(() => {
                        prevPageBtn.classList.remove('scale-95', 'opacity-80');
                        alert('Simulating: Navigate to PREVIOUS page');
                    }, 150);
                });
    
                nextPageBtn?.addEventListener('click', () => {
                    nextPageBtn.classList.add('scale-95', 'opacity-80');
                    setTimeout(() => {
                        nextPageBtn.classList.remove('scale-95', 'opacity-80');
                        alert('Simulating: Navigate to NEXT page');
                    }, 150);
                });
    
                 // --- Filter Tab Selection ---
                filterTabs.forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        // Prevent clicks on already active tab from doing much
                        if (tab.classList.contains('border-indigo-600')) return;
    
                        // Remove active state from all tabs
                        filterTabs.forEach(t => {
                            t.classList.remove('text-indigo-600', 'border-b-2', 'border-indigo-600');
                            t.classList.add('text-gray-500', 'hover:text-gray-700');
                        });
    
                        // Add active state to clicked tab
                        tab.classList.remove('text-gray-500', 'hover:text-gray-700');
                        tab.classList.add('text-indigo-600', 'border-b-2', 'border-indigo-600');
    
                        // Apply filter
                        const filterValue = tab.textContent.trim().toLowerCase();
                        applyStatusFilter(filterValue); // This will call filterClients internally
                    });
                });
    
                // --- Responsive Adjustments (Optional but good practice) ---
                const handleResize = () => {
                    // Example: Add touch-action for mobile if needed
                     const isMobile = window.innerWidth < 768; // Example breakpoint
                     container.querySelectorAll('button, a').forEach(el => {
                         el.style.touchAction = isMobile ? 'manipulation' : 'auto';
                     });
                };
    
                window.addEventListener('resize', handleResize);
    
    
                // --- Initial Setup ---
                initClientList(); // Run the initialization
                handleResize(); // Run initial responsive check
    
            })(); // End of IIFE
        </script>
</div> <!-- End SINC Client Management Container -->