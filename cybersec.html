<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VylexNexys CyberSec - What Websites Really Know About You | Privacy Awareness Tool</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Discover what personal information websites can collect about you through your browser. Educational privacy awareness tool showing real-time data exposure.">
    <meta name="keywords" content="privacy, browser fingerprinting, cybersecurity, digital privacy, online tracking, data protection, browser security">
    <meta name="robots" content="index, follow">
    <meta name="author" content="VylexNexys CyberSec">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="What Websites Really Know About You - Privacy Awareness Tool">
    <meta property="og:description" content="Educational tool revealing how much personal data your browser exposes to websites">
    <meta property="og:url" content="https://vylexnexys.co.za/cybersec">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Browser Privacy Awareness Tool">
    <meta name="twitter:description" content="See what data websites can collect about you">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "VylexNexys Privacy Awareness Tool",
        "description": "Educational tool demonstrating browser data exposure for privacy awareness",
        "url": "https://vylexnexys.co.za/cybersec",
        "applicationCategory": "SecurityApplication",
        "operatingSystem": "Web Browser"
    }
    </script>

    <style>
        :root {
            --primary-blue: #00d4ff;
            --dark-blue: #0099cc;
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #16213e;
            --text-primary: #ffffff;
            --text-secondary: #aaaaaa;
            --danger: #ef4444;
            --warning: #fbbf24;
            --success: #4ade80;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-tertiary) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 2px solid #333;
            margin-bottom: 40px;
            position: relative;
        }

        .logo {
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: bold;
            color: var(--primary-blue);
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }

        .tagline {
            font-size: clamp(1rem, 2vw, 1.2rem);
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .warning-banner {
            background: linear-gradient(45deg, var(--danger), #ff6b6b);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 30px;
            font-weight: bold;
            animation: pulse 2s infinite;
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.3);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.02); opacity: 0.9; }
        }

        .threat-level {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
            padding: 20px;
            background: var(--glass-bg);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .threat-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 30px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-blue), var(--dark-blue));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 212, 255, 0.15);
            border-color: var(--primary-blue);
        }

        .card:hover::before {
            opacity: 1;
        }

        .card h3 {
            color: var(--primary-blue);
            margin-bottom: 20px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card .value {
            font-size: 1.1rem;
            color: var(--text-primary);
            font-weight: bold;
            margin-bottom: 12px;
            word-break: break-all;
        }

        .card .detail {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .card .detail span {
            text-align: right;
        }


        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
            box-shadow: 0 0 10px currentColor;
        }

        .status-safe { background-color: var(--success); color: var(--success); }
        .status-warning { background-color: var(--warning); color: var(--warning); }
        .status-danger { background-color: var(--danger); color: var(--danger); }

        .fingerprint-section {
            background: rgba(239, 68, 68, 0.05);
            border: 2px solid rgba(239, 68, 68, 0.2);
            border-radius: 16px;
            padding: 40px;
            margin: 40px 0;
            position: relative;
        }

        .fingerprint-section::before {
            content: '⚠️ HIGH RISK DATA EXPOSURE';
            position: absolute;
            top: -12px;
            left: 20px;
            background: var(--danger);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .fingerprint-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .fingerprint-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            border-left: 4px solid var(--danger);
        }
        .fingerprint-item span:last-child {
            max-width: 60%;
            word-break: break-all;
            text-align: right;
        }


        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #333;
            border-radius: 50%;
            border-top-color: var(--primary-blue);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .accuracy-meter {
            background: rgba(255, 255, 255, 0.1);
            height: 25px;
            border-radius: 12px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
        }

        .accuracy-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--danger), #ff6b6b);
            transition: width 3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: bold;
            position: relative;
        }

        .privacy-tips {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(0, 153, 204, 0.05));
            border: 2px solid var(--primary-blue);
            border-radius: 16px;
            padding: 30px;
            margin: 40px 0;
        }

        .privacy-tips h3 {
            color: var(--primary-blue);
            margin-bottom: 20px;
        }

        .privacy-tips ul {
            margin: 20px 0 20px 30px;
        }

        .privacy-tips li {
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .btn {
            background: linear-gradient(45deg, var(--primary-blue), var(--dark-blue));
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 10px 10px 10px 0;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.4);
        }

        .danger-section {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(255, 107, 107, 0.05));
            border: 2px solid var(--danger);
            border-radius: 16px;
            padding: 30px;
            margin: 30px 0;
        }

        .real-time-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .data-point {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .data-point .label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .data-point .value {
            font-weight: bold;
            color: var(--danger);
            word-break: break-all;
        }

        .footer {
            text-align: center;
            padding: 50px 0;
            border-top: 1px solid #333;
            margin-top: 60px;
            color: #666;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .container {
                padding: 15px;
            }
            .card {
                padding: 20px;
            }
            .fingerprint-item span:last-child {
                max-width: 50%;
            }
        }

        .exposure-warning {
            background: rgba(239, 68, 68, 0.9);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            animation: urgentPulse 1.5s infinite;
        }

        @keyframes urgentPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        .info-value { /* Helper class for values that might be long */
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">🔒 VylexNexys.co.za/cybersec</div>
            <div class="tagline">Real-Time Browser Data Exposure Analysis</div>
            
            <div class="threat-level">
                <div class="threat-indicator status-danger"></div>
                <strong>THREAT LEVEL: <span id="threat-level-text">ANALYZING...</span></strong>
                <div class="threat-indicator status-danger"></div>
            </div>
            
            <div class="warning-banner">
                🚨 LIVE SURVEILLANCE SIMULATION - This is what websites see about you RIGHT NOW
            </div>
        </header>

        <div class="exposure-warning">
            <h2>⚠️ CRITICAL PRIVACY BREACH DETECTED</h2>
            <p>Your browser is actively exposing <span id="data-points-count">0</span> unique data points that can identify you personally</p>
        </div>

        <div class="grid">
            <div class="card">
                <h3>🌐 Network Fingerprint</h3>
                <div class="value" id="ip-address">Extracting IP address...</div>
                <div class="detail">ISP: <span id="isp-info" class="info-value">Identifying provider...</span></div>
                <div class="detail">VPN Status: <span id="vpn-status">Detecting...</span></div>
                <div class="detail">DNS Servers: <span id="dns-info">N/A (Client-side)</span></div>
                <div class="detail">Connection Type: <span id="connection-type">Analyzing...</span></div>
            </div>

            <div class="card">
                <h3>📍 Precise Location Data</h3>
                <div class="value" id="location">Triangulating position...</div>
                <div class="detail">GPS Coordinates: <span id="gps-coords">Acquiring...</span></div>
                <div class="detail">Accuracy: <span id="accuracy">Calculating...</span></div>
                <div class="detail">Altitude: <span id="altitude">Measuring...</span></div>
                <div class="detail">Speed: <span id="speed">Detecting...</span></div>
                <div class="detail">Timezone: <span id="timezone" class="info-value">UTC offset...</span></div>
            </div>

            <div class="card">
                <h3>💻 Hardware Profile</h3>
                <div class="value" id="device-type">Profiling device...</div>
                <div class="detail">CPU Cores: <span id="cpu-cores">Counting...</span></div>
                <div class="detail">RAM Estimate: <span id="ram-info">Estimating...</span></div>
                <div class="detail">GPU: <span id="gpu-info" class="info-value">Identifying...</span></div>
                <div class="detail">Architecture: <span id="architecture">x64/ARM...</span></div>
                <div class="detail">Platform: <span id="platform" class="info-value">Detecting...</span></div>
            </div>

            <div class="card">
                <h3>🔋 System Vitals</h3>
                <div class="value" id="battery-level">Reading battery...</div>
                <div class="detail">Charging: <span id="charging-status">Monitoring...</span></div>
                <div class="detail">Memory Usage: <span id="memory-usage">Analyzing...</span></div>
                <div class="detail">Network Speed: <span id="network-speed">Testing...</span></div>
                <div class="detail">Online Since: <span id="online-duration" class="info-value">Tracking...</span></div>
            </div>

            <div class="card">
                <h3>🖥️ Display Intelligence</h3>
                <div class="value" id="screen-resolution">Measuring display...</div>
                <div class="detail">Color Depth: <span id="color-depth">Analyzing...</span></div>
                <div class="detail">Pixel Ratio: <span id="pixel-ratio">Calculating...</span></div>
                <div class="detail">Orientation: <span id="orientation">Portrait/Landscape</span></div>
                <div class="detail">HDR Support: <span id="hdr-support">Testing...</span></div>
            </div>

            <div class="card">
                <h3>🕐 Behavioral Analytics</h3>
                <div class="value" id="local-time">Synchronizing time...</div>
                <div class="detail">Session Duration: <span id="timer">0s</span></div>
                <div class="detail">Visit Count: <span id="visit-count">Calculating...</span></div>
                <div class="detail">Mouse Activity: <span id="mouse-activity">0 moves</span></div>
                <div class="detail">Scroll Patterns: <span id="scroll-data">0px</span></div>
            </div>
        </div>

        <div class="fingerprint-section">
            <h2>🔍 Advanced Digital Fingerprinting</h2>
            <p style="margin-bottom: 20px; color: #fff; font-size: 1.1rem;">
                <strong>Unique Identification Probability: <span id="fingerprint-accuracy">Calculating...</span></strong>
            </p>
            <div class="accuracy-meter">
                <div class="accuracy-fill" id="accuracy-bar" style="width: 0%">0%</div>
            </div>
            
            <div class="fingerprint-grid">
                <div class="fingerprint-item">
                    <span>Canvas Signature:</span>
                    <span id="canvas-fp">Generating...</span>
                </div>
                <div class="fingerprint-item">
                    <span>WebGL Fingerprint:</span>
                    <span id="webgl-info">Extracting...</span>
                </div>
                <div class="fingerprint-item">
                    <span>Audio Context Hash:</span>
                    <span id="audio-fp">Processing...</span>
                </div>
                <div class="fingerprint-item">
                    <span>Font Enumeration:</span>
                    <span id="font-count">Scanning...</span>
                </div>
                <div class="fingerprint-item">
                    <span>Plugin Fingerprint:</span>
                    <span id="plugin-count">Enumerating...</span>
                </div>
                <div class="fingerprint-item">
                    <span>WebRTC Leak:</span>
                    <span id="webrtc-leak">Testing...</span>
                </div>
                <div class="fingerprint-item">
                    <span>Timezone Signature:</span>
                    <span id="timezone-fp">Calculating...</span>
                </div>
                <div class="fingerprint-item">
                    <span>Language Profile:</span>
                    <span id="language-profile" class="info-value">Detecting...</span>
                </div>
            </div>
        </div>

        <div class="danger-section">
            <h2>🚨 CRITICAL DATA EXPOSURE</h2>
            <p style="margin-bottom: 20px;"><strong>The following sensitive information is being broadcast by your browser:</strong></p>
            
            <div class="real-time-data">
                <div class="data-point">
                    <div class="label">User Agent Hash</div>
                    <div class="value" id="ua-hash">Generating...</div>
                </div>
                <div class="data-point">
                    <div class="label">Header-like Info Count</div>
                    <div class="value" id="header-count">0</div>
                </div>
                <div class="data-point">
                    <div class="label">DOM Storage</div>
                    <div class="value" id="storage-data">Scanning...</div>
                </div>
                <div class="data-point">
                    <div class="label">Cache Behavior</div>
                    <div class="value" id="cache-count">Untestable Client-side</div>
                </div>
                <div class="data-point">
                    <div class="label">WebSQL Support</div>
                    <div class="value" id="websql-data">Probing...</div>
                </div>
                <div class="data-point">
                    <div class="label">IndexedDB Support</div>
                    <div class="value" id="indexdb-data">Accessing...</div>
                </div>
            </div>
        </div>

        <div class="privacy-tips">
            <h3>🛡️ IMMEDIATE PROTECTION STEPS</h3>
            <p><strong>Take these actions NOW to protect your privacy:</strong></p>
            <ul>
                <li><strong>Use a VPN:</strong> Hide your real IP address and location</li>
                <li><strong>Browser Hardening:</strong> Disable JavaScript, WebGL, and geolocation where not needed. Use privacy-focused browsers.</li>
                <li><strong>Use Tor Browser:</strong> Maximum anonymity with onion routing for sensitive browsing.</li>
                <li><strong>Privacy Extensions:</strong> uBlock Origin, Privacy Badger, Decentraleyes.</li>
                <li><strong>Clear Data Regularly:</strong> Wipe cookies, cache, and browser history.</li>
                <li><strong>Compartmentalize:</strong> Use different browsers or profiles for different activities.</li>
                <li><strong>DNS Over HTTPS (DoH):</strong> Encrypt your DNS queries (browser/OS setting).</li>
                <li><strong>Disable WebRTC:</strong> If not needed, use browser extensions to prevent IP leaks.</li>
            </ul>
            
            <button class="btn" onclick="clearAllData()">🗑️ Emergency Data Wipe (Client)</button>
            <button class="btn" onclick="generateNewFingerprint()">🔄 Refresh Analysis</button>
            <button class="btn" onclick="exportThreatReport()">📊 Export Threat Report</button>
            <button class="btn" onclick="showProtectionGuide()">🛡️ Protection Guide (Alert)</button>
        </div>

        <footer class="footer">
            <p>© 2024 VylexNexys CyberSecurity Platform | Educational Privacy Awareness Tool</p>
            <p>This demonstration shows real browser data exposure techniques used by tracking companies</p>
            <p><strong>Your privacy matters. Take action today.</strong></p>
        </footer>
    </div>

    <script>
        // Global variables
        let startTime = Date.now();
        let sessionTimer;
        let mouseMovements = 0;
        let totalScrollDistance = 0; // Renamed to avoid conflict
        let dataPointsCollected = 0;
        let threatScore = 0;
        const MAX_THREAT_SCORE = 150; // Estimated max score

        // Helper to update DOM safely
        function updateDOM(id, value, isHtml = false) {
            const element = document.getElementById(id);
            if (element) {
                if (isHtml) element.innerHTML = value;
                else element.textContent = value;
            }
        }
        
        // Helper to add to score and update count
        function addDataPoint(points = 1, unique = false) {
            dataPointsCollected++;
            threatScore += points;
            if (unique) threatScore += 2; // Extra points for highly unique identifiers
            updateOverallMetrics();
        }

        function updateOverallMetrics() {
            updateDOM('data-points-count', dataPointsCollected);
            
            const percentage = Math.min(100, Math.round((threatScore / MAX_THREAT_SCORE) * 100));
            updateDOM('fingerprint-accuracy', `${percentage}% Unique`);
            const accuracyBar = document.getElementById('accuracy-bar');
            if (accuracyBar) {
                accuracyBar.style.width = `${percentage}%`;
                accuracyBar.textContent = `${percentage}%`;
            }

            let levelText = "LOW";
            let levelClass = "status-safe";
            if (percentage > 85) { levelText = "CRITICAL"; levelClass = "status-danger"; }
            else if (percentage > 60) { levelText = "HIGH"; levelClass = "status-danger"; }
            else if (percentage > 30) { levelText = "MEDIUM"; levelClass = "status-warning"; }
            
            updateDOM('threat-level-text', levelText);
            document.querySelectorAll('.threat-indicator').forEach(el => {
                el.className = `threat-indicator ${levelClass.replace('status-','')}`; // use color directly
            });
        }


        // Hashing (SHA-256 preferred, simpleHash as fallback)
        async function sha256(str) {
            try {
                if (typeof crypto !== 'undefined' && crypto.subtle && crypto.subtle.digest) {
                    const buffer = new TextEncoder().encode(str);
                    const hashBuffer = await crypto.subtle.digest('SHA-256', buffer);
                    const hashArray = Array.from(new Uint8Array(hashBuffer));
                    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                }
            } catch (e) { console.warn("SHA-256 via crypto.subtle failed:", e); }
            // Fallback simple hash if crypto API fails or not available (e.g. http)
            return simpleHash(str + '_fallback_salt_vns');
        }

        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash |= 0; // Convert to 32bit integer
            }
            return Math.abs(hash).toString(16).padStart(8, '0');
        }

        document.addEventListener('DOMContentLoaded', function() {
            initializeSurveillance();
            startRealTimeMonitoring();
        });

        document.addEventListener('mousemove', () => {
            mouseMovements++;
            updateDOM('mouse-activity', `${mouseMovements} moves`);
        });

        document.addEventListener('scroll', () => {
            totalScrollDistance = window.scrollY;
            updateDOM('scroll-data', `${Math.round(totalScrollDistance)}px`);
        });

        async function initializeSurveillance() {
            startSessionTimer();
            initVisitCounter();
            getNetworkIntelligence(); // async
            getPreciseLocation();
            analyzeHardwareProfile(); // contains async GPU
            monitorSystemVitals(); // contains async battery
            analyzeDisplayCapabilities();
            await generateAdvancedFingerprint(); // async
            await extractSensitiveData(); // async
            // Initial threat calculation, will be updated by async calls too
            updateOverallMetrics();
        }

        function startSessionTimer() {
            updateDOM('local-time', new Date().toLocaleTimeString());
            sessionTimer = setInterval(() => {
                const elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);
                updateDOM('timer', `${elapsedSeconds}s`);
                updateDOM('online-duration', `${elapsedSeconds}s`); // Keep this same as session timer for simplicity
                updateDOM('local-time', new Date().toLocaleTimeString());
            }, 1000);
        }
        
        function updateOnlineDuration() { // This function was defined but not used, combined with startSessionTimer
            // const firstVisit = localStorage.getItem('vylexnexys_firstVisitTime');
            // if (firstVisit) {
            //    const durationMs = Date.now() - parseInt(firstVisit);
            //    updateDOM('online-duration', `${Math.floor(durationMs / 1000)}s`);
            // } else {
            //    updateDOM('online-duration', 'Tracking...');
            // }
        }


        function initVisitCounter() {
            let visits = localStorage.getItem('vylexnexys_visits') || 0;
            visits = parseInt(visits) + 1;
            localStorage.setItem('vylexnexys_visits', visits);
            
            if (!localStorage.getItem('vylexnexys_firstVisitTime')) {
                localStorage.setItem('vylexnexys_firstVisitTime', Date.now().toString());
            }
            localStorage.setItem('vylexnexys_lastVisit', new Date().toISOString());
            updateDOM('visit-count', `Visit #${visits}`);
            addDataPoint(1);
        }

        async function getNetworkIntelligence() {
            try {
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                updateDOM('ip-address', ipData.ip);
                addDataPoint(3, true); // IP is highly identifying

                const geoResponse = await fetch(`https://ipapi.co/${ipData.ip}/json/`);
                const geoData = await geoResponse.json();
                updateDOM('isp-info', geoData.org || 'Unknown ISP');
                addDataPoint(1);

                const isVPN = geoData.org && (
                    geoData.org.toLowerCase().includes('vpn') ||
                    geoData.org.toLowerCase().includes('proxy') ||
                    geoData.org.toLowerCase().includes('hosting') ||
                    geoData.org.toLowerCase().includes('cloud')
                );
                updateDOM('vpn-status', isVPN ? 
                    '<span class="status-indicator status-warning"></span>VPN/Proxy Possible' :
                    '<span class="status-indicator status-danger"></span>Likely Direct', true);
                addDataPoint(1);

            } catch (error) {
                updateDOM('ip-address', 'Network info blocked/failed');
                updateDOM('isp-info', 'N/A');
                updateDOM('vpn-status', 'N/A');
                console.error('Network analysis error:', error);
            }

            if ('connection' in navigator) {
                const conn = navigator.connection;
                updateDOM('connection-type', 
                    `${conn.effectiveType || 'Unknown type'} (${conn.downlink ? conn.downlink + ' Mbps' : 'N/A speed'})`);
                addDataPoint(1);
            } else {
                updateDOM('connection-type', 'API N/A');
            }
        }

        function getPreciseLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude.toFixed(6);
                        const lng = position.coords.longitude.toFixed(6);
                        const acc = position.coords.accuracy;
                        
                        updateDOM('location', `${lat}, ${lng}`);
                        updateDOM('gps-coords', `Lat: ${lat}, Lon: ${lng}`);
                        updateDOM('accuracy', `±${Math.round(acc)}m`);
                        addDataPoint(5, true); // Precise location is very sensitive

                        if (position.coords.altitude) {
                            updateDOM('altitude', `${Math.round(position.coords.altitude)}m (±${position.coords.altitudeAccuracy}m)`);
                            addDataPoint(1);
                        } else { updateDOM('altitude', 'N/A');}
                        
                        if (position.coords.speed) {
                            updateDOM('speed', `${(position.coords.speed * 3.6).toFixed(1)} km/h`);
                            addDataPoint(1);
                        } else { updateDOM('speed', 'N/A');}
                    },
                    (error) => {
                        updateDOM('location', 'Location blocked/unavailable');
                        updateDOM('gps-coords', error.message);
                        updateDOM('accuracy', 'N/A');
                        updateDOM('altitude', 'N/A');
                        updateDOM('speed', 'N/A');
                    },
                    { enableHighAccuracy: true, timeout: 8000, maximumAge: 0 }
                );
            } else {
                updateDOM('location', 'Geolocation API N/A');
            }

            try {
                const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
                const offset = new Date().getTimezoneOffset();
                updateDOM('timezone', `${tz} (UTC${offset <= 0 ? '+' : '-'}${String(Math.abs(offset/60)).padStart(2,'0')}:${String(Math.abs(offset%60)).padStart(2,'0')})`);
                updateDOM('timezone-fp', `${tz} (Offset: ${offset})`);
                addDataPoint(1, true);
            } catch (e) {
                updateDOM('timezone', 'N/A');
                updateDOM('timezone-fp', 'N/A');
            }
        }
        
        function getGPUInfo() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (!gl) {
                    return 'WebGL N/A';
                }
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                if (debugInfo) {
                    const vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
                    const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                    return `${vendor} | ${renderer}`;
                }
                // Fallback for older WebGL info if debug_renderer_info is not available
                const rendererInfo = gl.getParameter(gl.RENDERER);
                 if (rendererInfo) return rendererInfo;

                return 'GPU Info Partially Available';
            } catch (e) {
                return 'Error retrieving GPU info';
            }
        }


        async function analyzeHardwareProfile() {
            updateDOM('cpu-cores', `${navigator.hardwareConcurrency || 'Unknown'} logical cores`);
            addDataPoint(1);
            
            if (navigator.deviceMemory) {
                 updateDOM('ram-info', `~${navigator.deviceMemory}GB System RAM`);
                 addDataPoint(1);
            } else if ('memory' in performance && performance.memory.jsHeapSizeLimit) { // JS Heap as fallback
                const memoryMB = Math.round(performance.memory.jsHeapSizeLimit / (1024*1024));
                updateDOM('ram-info', `~${memoryMB}MB (JS Heap Limit)`);
                addDataPoint(1);
            } else {
                updateDOM('ram-info', 'RAM N/A');
            }
            
            const gpuData = getGPUInfo();
            updateDOM('gpu-info', gpuData);
            if (gpuData !== 'WebGL N/A' && gpuData !== 'Error retrieving GPU info') addDataPoint(2, true);

            updateDOM('platform', navigator.platform || 'Unknown');
            addDataPoint(1);
            updateDOM('architecture', navigator.userAgent.toLowerCase().includes('x64') ? 'x64-based' : (navigator.userAgent.toLowerCase().includes('arm') ? 'ARM-based' : 'x86/Other'));
            addDataPoint(1);
            
            const ua = navigator.userAgent;
            let deviceType = 'Desktop Computer';
            if (/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua)) deviceType = 'Mobile/Tablet Device';
            updateDOM('device-type', deviceType);
            addDataPoint(1);
        }

        function monitorSystemVitals() {
            if ('getBattery' in navigator) {
                navigator.getBattery().then((battery) => {
                    const updateBattery = () => {
                        const level = Math.round(battery.level * 100);
                        const charging = battery.charging;
                        updateDOM('battery-level', `${level}% Battery`);
                        updateDOM('charging-status', charging ? 'Plugged In' : 'On Battery');
                    };
                    updateBattery();
                    battery.addEventListener('levelchange', updateBattery);
                    battery.addEventListener('chargingchange', updateBattery);
                    addDataPoint(1);
                }).catch(e => {
                    updateDOM('battery-level', 'Battery API N/A');
                    updateDOM('charging-status', 'N/A');
                });
            } else {
                updateDOM('battery-level', 'Battery API N/A');
                updateDOM('charging-status', 'N/A');
            }

            if ('memory' in performance && performance.memory.usedJSHeapSize) {
                const usedJSHeapMB = (performance.memory.usedJSHeapSize / (1024*1024)).toFixed(2);
                const totalJSHeapMB = (performance.memory.totalJSHeapSize / (1024*1024)).toFixed(2);
                updateDOM('memory-usage', `${usedJSHeapMB}MB / ${totalJSHeapMB}MB (JS Heap)`);
                addDataPoint(1);
            } else {
                updateDOM('memory-usage', 'Memory API N/A');
            }
            // Network speed is covered in getNetworkIntelligence via navigator.connection.downlink
            updateDOM('network-speed', document.getElementById('connection-type').textContent.split('(')[1]?.replace(')','') || 'See Connection Type');
        }

        function analyzeDisplayCapabilities() {
            updateDOM('screen-resolution', `${screen.width}x${screen.height} (Device: ${screen.availWidth}x${screen.availHeight} avail)`);
            addDataPoint(1);
            updateDOM('color-depth', `${screen.colorDepth}-bit`);
            addDataPoint(1);
            updateDOM('pixel-ratio', window.devicePixelRatio || 'N/A');
            addDataPoint(1);
            try {
                updateDOM('orientation', screen.orientation ? screen.orientation.type : (screen.width > screen.height ? 'landscape-primary' : 'portrait-primary'));
                addDataPoint(1);
            } catch (e) { updateDOM('orientation', 'N/A'); }
            
            updateDOM('hdr-support', 'Complex to detect reliably'); // Placeholder
        }
        
        async function getCanvasFingerprint() {
            try {
                const canvas = document.createElement('canvas');
                canvas.width = 200; canvas.height = 50;
                const ctx = canvas.getContext('2d');
                if (!ctx) return 'N/A (2D Context N/A)';
                
                const txt = `VylexNexys.co.za <canvas> fingerprint ${navigator.userAgent}`;
                ctx.textBaseline = "top";
                ctx.font = "14px 'Arial'";
                ctx.textBaseline = "alphabetic";
                ctx.fillStyle = "#f60";
                ctx.fillRect(125, 1, 62, 20);
                ctx.fillStyle = "#069";
                ctx.fillText(txt, 2, 15);
                ctx.fillStyle = "rgba(102, 204, 0, 0.7)";
                ctx.fillText(txt, 4, 17);
                
                // Add more drawing routines for robustness
                ctx.beginPath();
                ctx.arc(75, 25, 20, 0, Math.PI * 2, true);
                ctx.closePath();
                ctx.stroke();

                const dataUrl = canvas.toDataURL();
                return await sha256(dataUrl);
            } catch (e) {
                return 'Error or N/A';
            }
        }

        async function getWebGLFingerprint() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (!gl) return 'N/A (WebGL N/A)';
                
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                const vendor = gl.getParameter(debugInfo ? debugInfo.UNMASKED_VENDOR_WEBGL : gl.VENDOR);
                const renderer = gl.getParameter(debugInfo ? debugInfo.UNMASKED_RENDERER_WEBGL : gl.RENDERER);
                const version = gl.getParameter(gl.VERSION);
                const shadingLangVersion = gl.getParameter(gl.SHADING_LANGUAGE_VERSION);
                
                // Get some WebGL parameters
                const maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);
                const maxCubeMapTextureSize = gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE);
                const maxVertexAttribs = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);

                // Combine info into a string
                const glInfoString = `${vendor}|${renderer}|${version}|${shadingLangVersion}|${maxTextureSize}|${maxCubeMapTextureSize}|${maxVertexAttribs}`;
                return await sha256(glInfoString);
            } catch (e) {
                return 'Error or N/A';
            }
        }

        async function getAudioFingerprint() {
            try {
                const audioCtx = window.OfflineAudioContext || window.webkitOfflineAudioContext;
                if (!audioCtx) return 'N/A (AudioContext N/A)';
                
                const context = new audioCtx(1, 44100, 44100);
                const oscillator = context.createOscillator();
                oscillator.type = "triangle";
                oscillator.frequency.setValueAtTime(10000, context.currentTime);
                
                const compressor = context.createDynamicsCompressor();
                compressor.threshold.setValueAtTime(-50, context.currentTime);
                compressor.knee.setValueAtTime(40, context.currentTime);
                compressor.ratio.setValueAtTime(12, context.currentTime);
                compressor.attack.setValueAtTime(0, context.currentTime);
                compressor.release.setValueAtTime(0.25, context.currentTime);
                
                oscillator.connect(compressor);
                compressor.connect(context.destination);
                oscillator.start(0);
                
                const buffer = await context.startRendering();
                const PPCM_OFFSET = 200; // Define an offset to avoid initial silence/transients
                const PPCM_LENGTH = 5000; // How many samples to process
                const fingerprintSamples = buffer.getChannelData(0).slice(PPCM_OFFSET, PPCM_OFFSET + PPCM_LENGTH);
                const sum = fingerprintSamples.reduce((acc, val) => acc + Math.abs(val), 0);
                
                return await sha256(sum.toString());
            } catch (e) {
                console.error("AudioFP Error:", e);
                return 'Error or N/A';
            }
        }

        function getFontFingerprint() {
            const commonFonts = [
                'Arial', 'Verdana', 'Helvetica', 'Tahoma', 'Trebuchet MS', 'Times New Roman', 'Georgia', 
                'Garamond', 'Courier New', 'Brush Script MT', 'Calibri', 'Cambria', 'Candara', 'Consolas',
                'Constantia', 'Corbel', 'Segoe UI', 'Roboto', 'Droid Sans', 'Open Sans', 'Lato', 'Montserrat',
                'Noto Sans', 'Source Sans Pro', 'Poppins', 'Ubuntu', 'Raleway', 'Merriweather', 'Playfair Display'
            ];
            let availableFontsCount = 0;
            let detectedFontList = [];
            if (document.fonts && document.fonts.check) {
                commonFonts.forEach(font => {
                    if (document.fonts.check(`12px "${font}"`)) {
                        availableFontsCount++;
                        detectedFontList.push(font);
                    }
                });
                 // Sort for consistent hash if needed, though count is often enough
                // return await sha256(detectedFontList.sort().join(','));
                addDataPoint(2, true);
                return `${availableFontsCount}/${commonFonts.length} common fonts`;
            }
            return 'Font API N/A';
        }
        
        async function generateAdvancedFingerprint() {
            updateDOM('canvas-fp', await getCanvasFingerprint()); addDataPoint(3, true);
            updateDOM('webgl-info', await getWebGLFingerprint()); addDataPoint(3, true);
            updateDOM('audio-fp', await getAudioFingerprint()); addDataPoint(3, true);
            updateDOM('font-count', getFontFingerprint()); // addDataPoint is inside this func

            if (navigator.plugins) {
                let pluginText = "";
                if (navigator.plugins.length > 0) {
                    for(let i=0; i < navigator.plugins.length; i++) {
                        pluginText += navigator.plugins[i].name + (navigator.plugins[i].description || "") + (navigator.plugins[i].filename || "");
                    }
                    updateDOM('plugin-count', `${navigator.plugins.length} plugins (Hash: ${await sha256(pluginText)})`);
                    addDataPoint(2, true);
                } else {
                    updateDOM('plugin-count', 'No plugins / API restricted');
                }
            } else {
                updateDOM('plugin-count', 'Plugin API N/A');
            }

            // WebRTC
            let rtcStatus = '<span class="status-indicator status-success"></span>Likely Disabled/Unavailable';
            try {
                if (window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection) {
                     // More robust check might involve trying to create a connection
                    const pc = new (window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection)({iceServers:[]});
                    if (pc && typeof pc.createDataChannel === 'function') {
                        rtcStatus = '<span class="status-indicator status-warning"></span>Potentially Enabled (IP leak risk)';
                        addDataPoint(2);
                    }
                }
            } catch(e) { /* Default status is fine */ }
            updateDOM('webrtc-leak', rtcStatus, true);
            

            // Language Profile (already part of fingerprint if combined)
            const languages = navigator.languages ? navigator.languages.join(', ') : (navigator.language || 'N/A');
            updateDOM('language-profile', languages);
            addDataPoint(1, true);
        }

        async function extractSensitiveData() {
            updateDOM('ua-hash', await sha256(navigator.userAgent));
            addDataPoint(2, true);
            // "Header Count" - count of easily accessible header-like data points
            // User-Agent, Accept-Language, Platform, DNT, etc.
            let headerLikeCount = 0;
            if (navigator.userAgent) headerLikeCount++;
            if (navigator.language) headerLikeCount++;
            if (navigator.languages && navigator.languages.length > 0) headerLikeCount++;
            if (navigator.platform) headerLikeCount++;
            if ('connection' in navigator) headerLikeCount++; // Connection type, downlink, etc.
            if ('doNotTrack' in navigator || 'doNotTrack' in window) headerLikeCount++; 
            updateDOM('header-count', `${headerLikeCount} items`); addDataPoint(1);


            try {
                let lsSize = 0; let ssSize = 0;
                let lsEnabled = false; let ssEnabled = false;
                let lsItems = 0; let ssItems = 0;

                if (typeof localStorage !== 'undefined') {
                    lsEnabled = true;
                    localStorage.setItem('_vylex_test', '1');
                    localStorage.removeItem('_vylex_test');
                    lsItems = localStorage.length;
                    for(let i=0; i<localStorage.length; i++) {
                        lsSize += (localStorage.key(i) + localStorage.getItem(localStorage.key(i))).length;
                    }
                }
                if (typeof sessionStorage !== 'undefined') {
                    ssEnabled = true;
                    sessionStorage.setItem('_vylex_test', '1');
                    sessionStorage.removeItem('_vylex_test');
                    ssItems = sessionStorage.length;
                    for(let i=0; i<sessionStorage.length; i++) {
                        ssSize += (sessionStorage.key(i) + sessionStorage.getItem(sessionStorage.key(i))).length;
                    }
                }
                let storageReport = [];
                if(lsEnabled) storageReport.push(`LS: ${lsItems} items, ~${(lsSize/1024).toFixed(1)}KB`); else storageReport.push('LS: N/A');
                if(ssEnabled) storageReport.push(`SS: ${ssItems} items, ~${(ssSize/1024).toFixed(1)}KB`); else storageReport.push('SS: N/A');
                updateDOM('storage-data', storageReport.join(' | '));
                if(lsEnabled || ssEnabled) addDataPoint(1);

            } catch (e) {
                updateDOM('storage-data', 'Storage access blocked');
            }

            updateDOM('websql-data', window.openDatabase ? '<span class="status-indicator status-warning"></span>Supported (Legacy)' : '<span class="status-indicator status-success"></span>Not Supported', true);
            if(window.openDatabase) addDataPoint(1);
            updateDOM('indexdb-data', window.indexedDB ? '<span class="status-indicator status-warning"></span>Supported' : '<span class="status-indicator status-success"></span>Not Supported', true);
            if(window.indexedDB) addDataPoint(1);
        }
        
        function startRealTimeMonitoring() {
            // Some data is already real-time via event listeners (battery, timer)
            // This could be used for periodic re-checks if needed, but for now, most data is on-load.
        }

        // Button functionalities
        function clearAllData() {
            try {
                localStorage.clear();
                sessionStorage.clear();
                // Cookies are harder to clear client-side comprehensively for all paths/domains.
                // This only clears cookies for the current path.
                const cookies = document.cookie.split(";");
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i];
                    const eqPos = cookie.indexOf("=");
                    const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                    document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
                }
                alert('Client-side storage (localStorage, sessionStorage, current path cookies) cleared. Refresh to see changes. For full cache/history, use browser settings.');
                initVisitCounter(); // Reset visit counter display
            } catch (e) {
                alert('Error clearing data. Some storage might be protected or inaccessible.');
            }
            // Refresh to re-evaluate
            setTimeout(() => location.reload(true), 1000);
        }

        function generateNewFingerprint() {
            location.reload(true); // Force reload from server
        }

        function exportThreatReport() {
            const report = {
                timestamp: new Date().toISOString(),
                url: window.location.href,
                threatScore: threatScore,
                dataPointsCollected: dataPointsCollected,
                fingerprintAccuracy: document.getElementById('fingerprint-accuracy').textContent,
                details: {}
            };
            
            document.querySelectorAll('[id]').forEach(el => {
                if (el.id && (el.classList.contains('value') || el.classList.contains('info-value') || el.tagName === 'SPAN' && el.parentElement.classList.contains('detail') || el.parentElement.classList.contains('fingerprint-item') || el.parentElement.classList.contains('data-point'))) {
                    // Try to find a good label for the data
                    let label = el.id;
                    if (el.parentElement.classList.contains('detail') && el.previousSibling && el.previousSibling.nodeType === Node.TEXT_NODE) {
                        label = el.previousSibling.textContent.trim().replace(':', '');
                    } else if (el.parentElement.classList.contains('fingerprint-item') && el.previousElementSibling) {
                        label = el.previousElementSibling.textContent.trim().replace(':', '');
                    } else if (el.parentElement.classList.contains('data-point') && el.previousElementSibling && el.previousElementSibling.classList.contains('label')) {
                         label = el.previousElementSibling.textContent.trim();
                    }
                    report.details[label || el.id] = el.textContent || el.innerText;
                }
            });

            const reportString = JSON.stringify(report, null, 2);
            const blob = new Blob([reportString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `VylexNexys_PrivacyReport_${new Date().getTime()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function showProtectionGuide() {
            const tips = Array.from(document.querySelectorAll('.privacy-tips li'))
                              .map(li => `- ${li.textContent}`)
                              .join('\n');
            alert("🛡️ PRIVACY PROTECTION GUIDE 🛡️\n\nTake these actions NOW to protect your privacy:\n\n" + tips + "\n\nAlso, explore browser settings for enhanced privacy controls (tracking protection, third-party cookies, etc.).");
        }

    </script>
</body>
</html>
